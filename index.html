<!DOCTYPE html>
<html>
	<meta chartset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="">
	<meta name="author" content="">
	<head>
		<title>Album App</title>
		<script src="js/angular.js" type="text/javascript"></script>
		<link rel="stylesheet" type="text/css" href="css/styles.css">
	</head>
<body ng-app='app' ng-controller='albumsCtrl'>
<div class="wrapper">
	<nav class="navbar">
		<div class="container">
			<div class="navbar-header">
				<a class="navbar-brand">Album App</a>
			</div>
			<div class="">
				<ul class="nav">
					<li><a href=""></a></li>
					<li><a href=""></a></li>
				</ul>
			</div>
		</div>
	</nav>
	<div class="container">
		<div class="row">
			<div class="col-2 left">
				<input type="text" ng-model="searchFilter" class="form-control" placeholder="Search here...">
				<song-list album="allSongs" search="searchFilter"></song-list>
			</div>
			<div class="col-2">
				<div class="row">
					<div class="col-12">
						<div class="row">
							<div class="col-12">
								<label>Min required song per album:</label> 
								<input ng-model="reqSongs" type="number" class="form-control">
							</div>
							<div class="col-12">
								<label>Max mins to listen:</label> 
								<input ng-model='maxMins' type="number" class="form-control">
							</div>
						</div>
					</div>
					<div class="col-12">
						<div class="row">
							<div class="col-2">
								<h3>Album1</h3>
								<song-list album="album1"></song-list>
								<br>
								<a href="" ng-click="s1.showAdd();" class='btn btn-purple'>+ Add song</a>
								<br><br>
								<add-song ng-show="s1.show" s="s1" album="album1" ></add-song>
							</div>
							<div class="col-2">	
								<h3>Album2</h3>
								<song-list album="album2"></song-list>
								<br>
								<a href="" ng-click="s2.showAdd();" class='btn btn-purple'>+ Add song</a>
								<br><br>
								<add-song ng-show="s2.show" s="s2" album="album2"></add-song>
							</div>
						</div>
					</div>
					<div class="col-12">
						<br>
						<button class="btn btn-purple" ng-click="main()" >Get Max Songs</button>
						<span ng-show="songsListened"> Result: {{songsListened}} </span>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<script type="text/javascript">

	var app = angular.module('app', []);

	app.directive('songList', function() {
		return {
			restrict: 'E',
			scope: {
				album: "=",
				search: "="
			},
			template: "<table class='table'><thead><tr><th class='record-index'>#</th><th>Song Title</th><th>Duration</th></tr></thead><tbody><tr ng-repeat='song in album | filter: search | limitTo: 10'><td scope='row'>{{$index+1}}.</td><td>{{song.title}}</td><td>{{song.duration}} secs</td></tr></tbody></table>",
			link: function(scope, elements, attribute) {
				scope.delete = function(index) {
					scope.album.splice(index, 1);
				}
			}
		};
	});

	app.directive('addSong', function() {
		return {
			restrict: 'E',
			scope: {
				s: "=",
				album: "="
			},
			template: "<div class='containger-highlight'><label>Song Title</label><input  class='form-control' placeholder='Song title' type='text' ng-model='song.title'> <label>Song Duration</label> <input  class='form-control' placeholder='durations' type='number' ng-model='song.duration'> <button class='btn btn-purple' ng-click='save()'>Save</button> <button class='btn btn-purple' ng-click='cancel()'>Cancel</button></div>",
			link: function(scope, elements, attr) {
				
				scope.save = function() {
					scope.s.show = false;
					scope.album.push(scope.song);
					scope.song = {};
				}

				scope.cancel = function () {
					scope.s.show = false;
				}
			}
		}
	});

</script>
<script src="js/controller/albumCtrl.js" type="text/javascript"></script>
<script src="js/services/songsService.js" type="text/javascript"></script>
</body>
<html>